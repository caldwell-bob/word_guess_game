<!DOCTYPE html>
<html lang="en-us">

<head>
  <meta charset="UTF-8">
  <title>Word Guess Game</title>
</head>

<body>

  <div>
    <p id="directions-text">Press any key to get started!</p>
    <p id="userchoice-text"></p>
    <p id="computerchoice-text"></p>
    <p id="wins-text"></p>
    <p id="losses-text"></p>
    <p id="wordDisplay-text"></p>
    <p id="lettersGuessed-text"></p>
    <p id="guessesRemaining-text"></p>
  </div>

  <script type="text/javascript">
    // Creates an array of word choice options
    var wordChoices = ["python", "ruby", "php", "perl", "javascript"];
    var lettersGuessed = "";

    // Creating variables to hold the number of wins, losses, and ties. They start at 0.
    var wins = 0;
    var losses = 0;
    var ties = 0;

    // Create variables that hold references to the places in the HTML where we want to display things.
    var directionsText = document.getElementById("directions-text");
    var userChoiceText = document.getElementById("userchoice-text");
    var computerChoiceText = document.getElementById("computerchoice-text");
    var winsText = document.getElementById("wins-text");
    var lossesText = document.getElementById("losses-text");
    var wordText = document.getElementById("wordDisplay-text");
    var lettersGuessedText = document.getElementById("lettersGuessed-text");
    var guessesRemainingText = document.getElementById("guessesRemaining-text");

    // This function prints the letter place holder for the word to guess
    function initProgress(someWord) {
      theLine = "_"
      var fullString = [];
      for (i = 0; i < someWord.length; i++) {
        // fullString = fullString + theLine;
        fullString[i] = theLine;
        // console.log(fullString);
      }
      console.log(fullString);
      console.log(typeof (fullString));
      return fullString;
    }

    function updateProgress(guessTracker,theWord,theGuess){
      var fullString = [];
      fullString = guessTracker;
      for (var i =0; i < theWord.length; i++){
        if (theGuess == theWord[i]) {
          // console.log('Its a match at position ' + i + ' !!!')
          fullString[i] =  theGuess;
        }
      }
      return fullString;
    }
  
    // This function checks to see if letter pressed is in the word to guess or not
    function isLetterInWord(theUserGuess, theWord) {
      var isIn = false;
      if (theWord.includes(theUserGuess)) {
        // console.log(theUserGuess + " is in the word.")
        isIn = true;
      }
      return isIn;
    }

    function resetGame(theUserGuess, correctGuesses, lettersGuessed, guessRemaining) {
      theUserGuess = 0;
      correctGuesses = "";
      lettersGuessed = "";
      guessRemaining = 0;

      return theUserGuess, correctGuesses, lettersGuessed, guessRemaining;
        }
   
    // Randomly chooses a word from the wordChoices array.
    var word = wordChoices[Math.floor(Math.random() * wordChoices.length)];
    var guessRemaining = word.length;

    // tracks if we need to init the correctGuesses var
    var firstRun = true;

    // MAIN FUNCTION:  ran whenever the user presses a key.
    document.onkeyup = function (event) {

      // Determines which key was pressed.
      var userGuess = event.key;
      // console.log("userGuess: " + userGuess);

      guessRemaining = guessRemaining - 1;

      if (guessRemaining === 0) {
        alert("Game Over!!!!");
        losses ++;
        resetGame(userGuess, correctGuesses, lettersGuessed, guessRemaining)
        // TODO create function to reset data vars, choose new word
      }

      if (firstRun) {
        correctGuesses = initProgress(word);
        firstRun = false;
        // console.log("First run - correctGuess set to: " + correctGuesses);
      }

      if (isLetterInWord(userGuess, word)) {
        correctGuesses = updateProgress(correctGuesses, word, userGuess);
      } else {
        lettersGuessed += userGuess;
      }

      if (correctGuesses.includes("_")) {
       console.log("more guesses");
       } else {
         alert("You won!!!");
         wins ++;
        //  TODO need to call reset data set function...once created
       }

      // *************************** Display Content
      directionsText.textContent = "";
      winsText.textContent = "wins: " + wins;
      lossesText.textContent = "losses: " + losses;
      userChoiceText.textContent = "Letter Guessed: " + userGuess;
      computerChoiceText.textContent = "The word to guess is : " + word;
      wordText.textContent = "Guess the programming language: " + correctGuesses;
      lettersGuessedText.textContent = "Letters guessed: " + lettersGuessed;
      guessesRemainingText.textContent = "Guesses remaining: " + guessRemaining;

      

      // TODO Special action on word guess

    };
  </script>

</body>

</html>